<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home Insurance Policy Report</title>
    <style>
        /* --- FONT IMPORTS --- */
        @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap');
        
        /* Color palette - xhtml2pdf doesn't support CSS variables */
        
        /* --- BASE & DOCUMENT STYLES --- */
        @page {
            size: letter;
            margin: 0.5in 0.75in;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: white;
            color: #374151;
            margin: 0;
            padding: 0;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .page-container {
            background-color: white;
            position: relative;
            border: 1px solid #D1D5DB;
            padding: 1.5rem;
            page-break-after: always;
            min-height: 9in;
        }
        
        .page-container:last-child {
            page-break-after: auto;
        }
        
        p, div, table, tr, td {
            margin: 0;
            padding: 0;
            border: none;
        }
        
        /* --- TYPOGRAPHY --- */
        .font-OpenSans { font-family: 'Open Sans', sans-serif; }
        .times-new-roman { font-family: 'Times New Roman', Times, serif; }
        .text-2xl { font-size: 1.5rem; }
        .text-lg { font-size: 1.125rem; }
        .text-sm { font-size: 0.875rem; }
        .text-base { font-size: 1rem; }
        .text-10px { font-size: 10px; }
        .font-bold { font-weight: 700; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .text-bgMenu { color: #111827; }
        .text-secondary500 { color: #6B7280; }
        .text-primary700 { color: #D97706; }
        .text-secondary600 { color: #4B5563; }
        .text-secondary700 { color: #374151; }
        .text-secondary800 { color: #1F2937; }
        
        /* --- SPECIFIC COMPONENTS --- */
        .rounded-md { border-radius: 0.375rem; }
        .object-cover { object-fit: cover; }
        
        /* --- HEADER LOGO --- */
        .logo-container {
            text-align: center;
        }
        
        .logo-text {
            font-family: 'Open Sans', sans-serif;
            font-size: 2.1rem;
            font-weight: 500;
            background: linear-gradient(90deg, #F97316 0%, #3B82F6 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: #000000; /* Fallback for PDF */
            display: inline-block;
            vertical-align: middle;
            letter-spacing: -0.05em;
        }
        
        /* --- SUBMISSION & PROPERTY INFO TABLE --- */
        .info-table {
            width: 100%;
            margin-top: 2.5rem;
            padding: 0 2.75rem;
            border-spacing: 29px 0;
            border-collapse: separate;
        }
        
        .info-label {
            font-size: 9px;
            font-weight: bold;
            color: #6B7280;
        }
        
        .info-text {
            font-size: 1.5rem;
            font-weight: 400;
            color: #D97706;
            margin-top: 0.25rem;
            display: block;
        }

        /* --- ICON STYLES --- */
        .icon-calendar {
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-right: 6px;
        }

        .icon-property {
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-right: 6px;
        }

        .property-image {
            max-height: 126px;
            max-width: 202px;
            border-radius: 0.375rem;
            background: #f3f4f6;
            display: block;
        }
        
        .property-caption {
            font-size: 10px;
            color: #4B5563;
            margin-top: 0.25rem;
        }
        
        /* --- DIVIDER --- */
        .divider {
            /* margin-top: 1.5rem;
            margin-bottom: 14px;
            height: 0.9px; */
            width: 100%;
            /* background-color: #525354; */
            border-bottom: solid 3px #b6b7b8;
        }
        
        /* --- REPORT TITLE --- */
        .report-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #374151;
            padding: 2rem 0 1rem;
        }
        
        /* --- WATERMARK --- */
        .watermark {
            position: absolute;
            bottom: 0;
            left: 0;
            z-index: -1;
            opacity: 0.1;
            width: 283px;
            height: 283px;
        }
        
        /* --- CONTENT AREA --- */
        .content-area {
            padding: 1.25rem;
            min-height: 600px;
        }
        
        .question-container {
            margin-bottom: 1.5rem;
        }
        
        .question-header {
            margin-bottom: 1rem;
        }
        
        .question-arrow {
            /* height: 1.2rem;
            width: 1.2rem; */
            margin-right: 1rem;
            display: inline-block;
            vertical-align: middle;
            color: #F97316; 
            font-size: 1.5rem; 
            font-weight: 500;
        }
        
        .question-text {
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #1F2937;
            display: inline;
        }
        
        /* --- MARKDOWN CONTENT --- */
        .markdown-content p {
            font-family: 'Times New Roman', Times, serif;
            color: #4B5563;
            line-height: 1.6;
        }
        
        .details-container {
            margin-top: 1.5rem;
            overflow: hidden;
            border-top-right-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
            border-left: 4px solid #F97316;
            background-color: white;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
        }
        
        .details-inner { 
            padding: 1.25rem; 
        }
        
        .details-section { 
            margin-bottom: 1.5rem; 
        }
        
        .details-heading {
            font-size: 1rem;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 0.75rem;
        }
        
        .details-icon {
            color: #F97316;
            margin-right: 0.5rem;
        }
        
        .details-box {
            border-radius: 0.5rem;
            border: 1px solid #F3F4F6;
            background-color: #F9FAFB;
            padding: 1rem;
        }
        
        .details-text {
            line-height: 1.625;
            color: #374151;
            margin-bottom: 0.75rem;
        }
        
        .reference-row {
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }
        
        .reference-label {
            width: 7rem;
            flex-shrink: 0;
            font-weight: 500;
            color: #374151;
            display: inline-block;
        }
        
        .reference-value {
            color: #1F2937;
            border: 1px solid #E5E7EB;
            background: white;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            display: inline-block;
        }
        
        .reference-section {
            border-top: 1px solid #F3F4F6;
            padding-top: 1.25rem;
        }
        
        .reference-heading {
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
        }
        
        .reference-icon {
            color: #3B82F6;
            margin-right: 0.5rem;
        }
        
        .reference-box {
            border-radius: 0.5rem;
            border: 1px solid #DBEAFE;
            background-color: #EFF6FF;
            padding: 1rem;
        }
        
        .reference-tag {
            display: inline-block;
            border: 1px solid #BFDBFE;
            background: white;
            border-radius: 9999px;
            padding: 0.375rem 0.75rem;
            margin: 0.25rem 0.25rem 0.25rem 0;
            font-size: 0.75rem;
            font-weight: 500;
            color: #1D4ED8;
        }
        
        /* --- PAGE FOOTER --- */
        .page-footer {
            text-align: right;
            margin-right: 1rem;
            margin-top: 2rem;
        }
        
        .page-number {
            font-family: 'Open Sans', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            color: #4B5563;
        }
        
        /* Keep content together */
        .keep-together {
            page-break-inside: avoid;
        }
    </style>
</head>
<body>
    {% if questions_answers %}
        {% for qa_item in questions_answers %}
        <div class="page-container">
            {% if loop.first %}
            <!-- HEADER (First page only) -->
            <div class="logo-container">
                <span class="logo-text">
                    <img src="cri-logo.png" width="45" height="37" alt="Go Clarifi" title="Go Clarifi" />
                    GoClarifi
                </span>
            </div>
            
            <!-- SUBMISSION & PROPERTY INFO -->
            <table class="info-table">
                <tr>
                    <td style="vertical-align: top;">
                        <div style="margin-bottom: 24px;">
                            <p class="info-label">DATE OF SUBMISSION</p>
                            <p class="info-text">
                                <img src="calendar.png" width="20" height="20" class="icon-calendar" alt="calendar" title="Calendar" />&nbsp;&nbsp;&nbsp;{{ policy_report.formatted_date|default("Sep 18, 2025, 19:29 PM") }}
                            </p>
                        </div>
                        <div>&nbsp;</div>
                        <div>
                            <p class="info-label">PROPERTY ADDRESS</p>
                            <p class="info-text">
                                <img src="property.png" width="20" height="20" class="icon-property" alt="Property" title="Property" />&nbsp;&nbsp;&nbsp;{{ policy_report.home_value_address|default("Property Address Not Available") }}
                            </p>
                        </div>
                    </td>
                    <td style="vertical-align: top; width: 202px;">
                        {% if policy_report.home_value_img_data %}
                        <div>
                            <div class="property-image" style="padding: 1rem; text-align: center;">
                                <img src="{{ policy_report.home_value_img_data }}" 
                                     alt="Property Image" 
                                     style="max-width: 100%; max-height: 200px; border-radius: 0.5rem;" />
                            </div>
                        </div>
                        {% elif policy_report.home_value_img %}
                        <div>
                            <div class="property-image" style="padding: 1rem; text-align: center;">
                                <img src="sin_imagen.jpg" 
                                     alt="Property Image" 
                                     style="max-width: 50%; max-height: 100px; border-radius: 0.5rem;" />
                            </div>
                        </div>
                        <p class="property-caption">
                            {{ policy_report.home_value_address|default("") }}
                        </p>
                        {% endif %}
                    </td>
                </tr>
            </table>
            
            <!-- DIVIDER -->
            <div class="divider">&nbsp;</div>
            
            <!-- REPORT TITLE -->
            <p class="report-title">Home Insurance Policy Report</p>
            {% endif %}
            
            <!-- WATERMARK -->
            <div class="watermark"></div>
            
            <!-- CONTENT AREA -->
            <div class="content-area">
                <div class="question-container keep-together">
                    <div class="question-header">
                        <span class="question-arrow" >&#10095;</span>
                        <div class="question-text">&nbsp;&nbsp;{{ qa_item.question|default("Question not available") }}</div>
                    </div>
                    <div class="markdown-content">
                        <p style="font-size: 1.5rem; margin-bottom: 2rem;">{{ qa_item.answer|default("Answer not available") }}</p>
                        
                        {% if qa_item.policy_details or qa_item.text_reference or qa_item.policy_reference_points %}
                        <div class="details-container">
                            <div class="details-inner">
                                {% if qa_item.policy_details %}
                                <div class="details-section">
                                    <div class="details-heading">
                                        <span class="details-icon" style="color: #F97316; font-size: 1.1rem;">●</span>
                                        Policy Details
                                    </div>
                                    <div class="details-box">
                                        <p class="details-text">
                                            {{ qa_item.policy_details }}
                                        </p>
                                        {% if qa_item.text_reference %}
                                        <div class="reference-row">
                                            <span class="reference-label">Reference:</span>
                                            <span class="reference-value" style="background: white; padding: 0.25rem 0.75rem; border: 1px solid #E5E7EB; border-radius: 0.375rem;">
                                                {{ qa_item.text_reference }}
                                            </span>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endif %}
                                
                                {% if qa_item.policy_reference_points %}
                                <div class="reference-section" style="border-top: 1px solid #E5E7EB; padding-top: 1.25rem; margin-top: 1rem;">
                                    <div class="reference-heading">
                                        <span class="reference-icon" style="color: #3B82F6; font-size: 1.1rem;">▪</span>
                                        Policy Reference Points
                                    </div>
                                    <div class="reference-box" style="background-color: #EFF6FF; padding: 1rem; border-radius: 0.5rem;">
                                        {% for point in qa_item.policy_reference_points %}
                                        <span class="reference-tag" style="display: inline-block; background: white; border: 1px solid #BFDBFE; border-radius: 9999px; padding: 0.375rem 0.75rem; margin: 0.25rem; font-size: 0.75rem; font-weight: 500; color: #1E40AF;">
                                            Page {{ point }}
                                        </span>
                                        {% endfor %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <!-- PAGE FOOTER -->
            <div class="page-footer">
                <span class="page-number">{{ loop.index }}</span>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <!-- No data page -->
        <div class="page-container">
            <div class="logo-container">
                <span class="logo-text">
                    <span style="color: #F97316; font-size: 1.8rem;">◆</span> GoClarifi
                </span>
            </div>
            
            <div class="divider"></div>
            
            <p class="report-title">Home Insurance Policy Report</p>
            
            <div class="content-area">
                <div class="question-container">
                    <p style="text-align: center; color: #6B7280; padding: 3rem;">
                        No policy analysis data available. Please ensure the policy has been processed.
                    </p>
                </div>
            </div>
            
            <div class="page-footer">
                <span class="page-number">1</span>
            </div>
        </div>
    {% endif %}
</body>
</html>